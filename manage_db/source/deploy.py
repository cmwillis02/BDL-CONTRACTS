import sys

import MySQLdb as sqldb
import manage_db as DB
import datetime

# Deployment class:  Inherits DB connection from connect_db.
class Deploy(DB.Manage_db):

	def __init__(self):
		DB.Manage_db.__init__(self)

	def franchise_populate(self, franchise_id, team_name, owner_email, owner_name):

		self.cur.execute(
						"INSERT INTO contracts_franchise (franchise_id, team_name, owner_email, owner_name) VALUES(%s, %s, %s, %s)",(franchise_id, team_name, owner_email, owner_name)
						)

	def create_tables(self):

		self.cur.execute(
						"DROP TABLE IF EXISTS url_reference"
						)

		self.cur.execute(
						"CREATE TABLE url_reference (year INTEGER, url INTEGER, league_id INTEGER)"
						)

		self.cur.execute(
						"DROP TABLE IF EXISTS job_dim"
						)

		self.cur.execute(
						"CREATE TABLE job_dim (job_id INTEGER UNIQUE PRIMARY KEY, job_name VARCHAR(50), active_flg INTEGER)"
						)

		self.cur.execute(
						"DROP TABLE IF EXISTS job_calendar"
						)

		self.cur.execute(
						"CREATE TABLE job_calendar (id INTEGER PRIMARY KEY AUTO_INCREMENT, week INTEGER, job_id INTEGER)"
						)

	def url_populate(self, year, url, league_id):

		self.cur.execute(
						"INSERT INTO url_reference (year, url, league_id) VALUES (%s, %s, %s)",(year, url, league_id)
						)

	def job_populate(self, id, name, active_flg):

		self.cur.execute(
						"INSERT INTO job_dim (job_id, job_name, active_flg) VALUES (%s, %s, %s)", (id, name, active_flg)
						)

	def calendar_populate(self, week, job_id):

		self.cur.execute(
						"INSERT INTO job_calendar (week, job_id) VALUES (%s, %s)", (week, job_id)
						)
	def week_populate(self,week_id, year, week, start_date, end_date):

		self.cur.execute(
						"INSERT INTO contracts_week (week_id, year, week, start_date, end_date, run_status) VALUES (%s, %s, %s, %s, %s, %s)", (week_id, year, week, datetime.date(start_date[0], start_date[1], start_date[2]), datetime.date(end_date[0], end_date[1], end_date[2]), 0)
						)


# Initial Data
FRANCHISE_DATA= [
					(1, 'The Truth', 'test@gmail.com', 'Mike Palmer'),
					(2, 'Baby Steps', 'test2@gmail.com', 'Nathan Scheffey'),
					(3, 'OhHeBack', 'test3@gmail.com', 'Brett Godin'),
					(4, 'Hit Stick Hero', 'test4@gmail.com', 'Sameer Joshi'),
					(5, 'Hot Sub Hawkes', 'test5@gmail.com', 'Chris Hawkes'),
					(6, 'Team Hoey', 'test6@gmail.com', 'Joey Hope'),
					(7, 'Team Ryan Burkes', 'test7@gmail.com', 'Ryan Burkes'),
					(8, 'One Man Wolfpack', 'cmwillis02@gmail.com', 'Craig Willis'),
					(9, 'McNutty', 'test9@gmail.com', 'Micah Deloache'),
					(10, 'Team Cary What', 'test10@gmail.com', 'Eddie Sato')
					]

URL_DATA= [
					(2009, 55, 52094),
					(2010, 59, 46342),
					(2011, 54, 18198),
					(2012, 65, 40396),
					(2013, 63, 34909),
					(2014, 56, 22529),
					(2015, 56, 37270),
					(2016, 56, 21676),
					(2017, 61, 21676),
					]

JOB_DATA= [
					(1, 'player_dim_update', 1),
					(2, 'roster_update', 0),
					(3, 'fact_update', 1),
					(4, 'playoff_update', 1),
					]

JOB_CALENDAR_DATA= [
					(1, 1),
					(1, 2),
					(1, 3),
					(2, 1),
					(2, 2),
					(2, 3),
					(3, 1),
					(3, 2),
					(3, 3),
					(4, 1),
					(4, 2),
					(4, 3),
					(5, 1),
					(5, 2),
					(5, 3),
					(6, 1),
					(6, 2),
					(6, 3),
					(7, 1),
					(7, 2),
					(7, 3),
					(8, 1),
					(8, 2),
					(8, 3),
					(9, 1),
					(9, 2),
					(9, 3),
					(10, 1),
					(10, 2),
					(10, 3),
					(11, 1),
					(11, 2),
					(11, 3),
					(12, 1),
					(12, 2),
					(12, 3),
					(13, 1),
					(13, 2),
					(13, 3),
					(14, 1),
					(14, 2),
					(14, 3),
					(14, 4),
					(15, 1),
					(15, 2),
					(15, 3),
					(15, 4),
					(16, 1),
					(16, 2),
					(16, 3),
					(16, 4),
					]

WEEK_DATA= [
			(200901,2009,1,(2009,9,8),(2009,9,14)),
			(200902,2009,2,(2009,9,15),(2009,9,21)),
			(200903,2009,3,(2009,9,22),(2009,9,28)),
			(200908,2009,8,(2009,10,27),(2009,11,2)),
			(200909,2009,9,(2009,11,3),(2009,11,9)),
			(200910,2009,10,(2009,11,10),(2009,11,16)),
			(200911,2009,11,(2009,11,17),(2009,11,23)),
			(201506,2015,6,(2015,10,13),(2015,10,19)),
			(201507,2015,7,(2015,10,20),(2015,10,26)),
			(201508,2015,8,(2015,10,27),(2015,11,2)),
			(201509,2015,9,(2015,11,3),(2015,11,9)),
			(201510,2015,10,(2015,11,10),(2015,11,16)),
			(201511,2015,11,(2015,11,17),(2015,11,23)),
			(201211,2012,11,(2012,11,13),(2012,11,19)),
			(201301,2013,1,(2013,9,3),(2013,9,9)),
			(201308,2013,8,(2013,10,22),(2013,10,28)),
			(201315,2013,15,(2013,12,10),(2013,12,16)),
			(201405,2014,5,(2014,9,30),(2014,10,6)),
			(201412,2014,12,(2014,11,18),(2014,11,24)),
			(201502,2015,2,(2015,9,15),(2015,9,21)),
			(201515,2015,15,(2015,12,15),(2015,12,21)),
			(201605,2016,5,(2016,10,4),(2016,10,10)),
			(201613,2016,13,(2016,11,29),(2016,12,5)),
			(201799,2017,99,(2018,1,2),(2018,9,1)),
			(200907,2009,7,(2009,10,20),(2009,10,26)),
			(200912,2009,12,(2009,11,24),(2009,11,30)),
			(201616,2016,16,(2016,12,20),(2016,12,26)),
			(200913,2009,13,(2009,12,1),(2009,12,7)),
			(200914,2009,14,(2009,12,8),(2009,12,14)),
			(200915,2009,15,(2009,12,15),(2009,12,21)),
			(201617,2016,17,(2016,12,27),(2016,1,2)),
			(201701,2017,1,(2017,9,5),(2017,9,11)),
			(200916,2009,16,(2009,12,22),(2009,12,28)),
			(201702,2017,2,(2017,9,12),(2017,9,18)),
			(201703,2017,3,(2017,9,19),(2017,9,25)),
			(200917,2009,17,(2009,12,29),(2009,1,4)),
			(201001,2010,1,(2010,9,7),(2010,9,13)),
			(201002,2010,2,(2010,9,14),(2010,9,20)),
			(201003,2010,3,(2010,9,21),(2010,9,27)),
			(201705,2017,5,(2017,10,3),(2017,10,9)),
			(201004,2010,4,(2010,9,28),(2010,10,4)),
			(201706,2017,6,(2017,10,10),(2017,10,16)),
			(201707,2017,7,(2017,10,17),(2017,10,23)),
			(201704,2017,4,(2017,9,26),(2017,10,2)),
			(200906,2009,6,(2009,10,13),(2009,10,19)),
			(200904,2009,4,(2009,9,29),(2009,10,5)),
			(201709,2017,9,(2017,10,31),(2017,11,6)),
			(201710,2017,10,(2017,11,7),(2017,11,13)),
			(201711,2017,11,(2017,11,14),(2017,11,20)),
			(201712,2017,12,(2017,11,21),(2017,11,27)),
			(201713,2017,13,(2017,11,28),(2017,12,4)),
			(201005,2010,5,(2010,10,5),(2010,10,11)),
			(201006,2010,6,(2010,10,12),(2010,10,18)),
			(201007,2010,7,(2010,10,19),(2010,10,25)),
			(201008,2010,8,(2010,10,26),(2010,11,1)),
			(201009,2010,9,(2010,11,2),(2010,11,8)),
			(201010,2010,10,(2010,11,9),(2010,11,15)),
			(201011,2010,11,(2010,11,16),(2010,11,22)),
			(201012,2010,12,(2010,11,23),(2010,11,29)),
			(201013,2010,13,(2010,11,30),(2010,12,6)),
			(201014,2010,14,(2010,12,7),(2010,12,13)),
			(201015,2010,15,(2010,12,14),(2010,12,20)),
			(201016,2010,16,(2010,12,21),(2010,12,27)),
			(201017,2010,17,(2010,12,28),(2010,1,3)),
			(201101,2011,1,(2011,9,6),(2011,9,12)),
			(201102,2011,2,(2011,9,13),(2011,9,19)),
			(201103,2011,3,(2011,9,20),(2011,9,26)),
			(201104,2011,4,(2011,9,27),(2011,10,3)),
			(201105,2011,5,(2011,10,4),(2011,10,10)),
			(201106,2011,6,(2011,10,11),(2011,10,17)),
			(201107,2011,7,(2011,10,18),(2011,10,24)),
			(201108,2011,8,(2011,10,25),(2011,10,31)),
			(201109,2011,9,(2011,11,1),(2011,11,7)),
			(201110,2011,10,(2011,11,8),(2011,11,14)),
			(201111,2011,11,(2011,11,15),(2011,11,21)),
			(201112,2011,12,(2011,11,22),(2011,11,28)),
			(201113,2011,13,(2011,11,29),(2011,12,5)),
			(201114,2011,14,(2011,12,6),(2011,12,12)),
			(201115,2011,15,(2011,12,13),(2011,12,19)),
			(201116,2011,16,(2011,12,20),(2011,12,26)),
			(201117,2011,17,(2011,12,27),(2011,1,2)),
			(201201,2012,1,(2012,9,4),(2012,9,10)),
			(201202,2012,2,(2012,9,11),(2012,9,17)),
			(201203,2012,3,(2012,9,18),(2012,9,24)),
			(201204,2012,4,(2012,9,25),(2012,10,1)),
			(201205,2012,5,(2012,10,2),(2012,10,8)),
			(201206,2012,6,(2012,10,9),(2012,10,15)),
			(201207,2012,7,(2012,10,16),(2012,10,22)),
			(201208,2012,8,(2012,10,23),(2012,10,29)),
			(201209,2012,9,(2012,10,30),(2012,11,5)),
			(201210,2012,10,(2012,11,6),(2012,11,12)),
			(201212,2012,12,(2012,11,20),(2012,11,26)),
			(201213,2012,13,(2012,11,27),(2012,12,3)),
			(201214,2012,14,(2012,12,4),(2012,12,10)),
			(201215,2012,15,(2012,12,11),(2012,12,17)),
			(201216,2012,16,(2012,12,18),(2012,12,24)),
			(201217,2012,17,(2012,12,25),(2012,12,31)),
			(201302,2013,2,(2013,9,10),(2013,9,16)),
			(201303,2013,3,(2013,9,17),(2013,9,23)),
			(201304,2013,4,(2013,9,24),(2013,9,30)),
			(201305,2013,5,(2013,10,1),(2013,10,7)),
			(201306,2013,6,(2013,10,8),(2013,10,14)),
			(201307,2013,7,(2013,10,15),(2013,10,21)),
			(201309,2013,9,(2013,10,29),(2013,11,4)),
			(201310,2013,10,(2013,11,5),(2013,11,11)),
			(201311,2013,11,(2013,11,12),(2013,11,18)),
			(201312,2013,12,(2013,11,19),(2013,11,25)),
			(201313,2013,13,(2013,11,26),(2013,12,2)),
			(201314,2013,14,(2013,12,3),(2013,12,9)),
			(201316,2013,16,(2013,12,17),(2013,12,23)),
			(201317,2013,17,(2013,12,24),(2013,12,30)),
			(201401,2014,1,(2014,9,2),(2014,9,8)),
			(201402,2014,2,(2014,9,9),(2014,9,15)),
			(201403,2014,3,(2014,9,16),(2014,9,22)),
			(201404,2014,4,(2014,9,23),(2014,9,29)),
			(201406,2014,6,(2014,10,7),(2014,10,13)),
			(201407,2014,7,(2014,10,14),(2014,10,20)),
			(201408,2014,8,(2014,10,21),(2014,10,27)),
			(201409,2014,9,(2014,10,28),(2014,11,3)),
			(201410,2014,10,(2014,11,4),(2014,11,10)),
			(201411,2014,11,(2014,11,11),(2014,11,17)),
			(201413,2014,13,(2014,11,25),(2014,12,1)),
			(201414,2014,14,(2014,12,2),(2014,12,8)),
			(201415,2014,15,(2014,12,9),(2014,12,15)),
			(201416,2014,16,(2014,12,16),(2014,12,22)),
			(201417,2014,17,(2014,12,23),(2014,12,29)),
			(201501,2015,1,(2015,9,8),(2015,9,14)),
			(201503,2015,3,(2015,9,22),(2015,9,28)),
			(201504,2015,4,(2015,9,29),(2015,10,5)),
			(201505,2015,5,(2015,10,6),(2015,10,12)),
			(201512,2015,12,(2015,11,24),(2015,11,30)),
			(201513,2015,13,(2015,12,1),(2015,12,7)),
			(201514,2015,14,(2015,12,8),(2015,12,14)),
			(201516,2015,16,(2015,12,22),(2015,12,28)),
			(201517,2015,17,(2015,12,29),(2015,1,4)),
			(201601,2016,1,(2016,9,6),(2016,9,12)),
			(201602,2016,2,(2016,9,13),(2016,9,19)),
			(201603,2016,3,(2016,9,20),(2016,9,26)),
			(201604,2016,4,(2016,9,27),(2016,10,3)),
			(201606,2016,6,(2016,10,11),(2016,10,17)),
			(201607,2016,7,(2016,10,18),(2016,10,24)),
			(201608,2016,8,(2016,10,25),(2016,10,31)),
			(201610,2016,10,(2016,11,8),(2016,11,14)),
			(201611,2016,11,(2016,11,15),(2016,11,21)),
			(201612,2016,12,(2016,11,22),(2016,11,28)),
			(201614,2016,14,(2016,12,6),(2016,12,12)),
			(201615,2016,15,(2016,12,13),(2016,12,19)),
			(200905,2009,5,(2009,10,6),(2009,10,12)),
			(201708,2017,8,(2017,10,24),(2017,10,30)),
			(201609,2016,9,(2016,11,1),(2016,11,7)),
			(201714,2017,14,(2017,12,5),(2017,12,11)),
			(201715,2017,15,(2017,12,12),(2017,12,18)),
			(201716,2017,16,(2017,12,19),(2017,12,25)),
			(201717,2017,17,(2017,12,26),(2017,1,1)),
			]

WEEKS_2018 = [
				(201801, 2018, 1, (2018,9,6), (2018, 9, 10)),
				(201802, 2018, 2, (2018,9,11), (2018, 9, 17)),
				(201803, 2018, 3, (2018,9,18), (2018, 9, 24)),
				(201804, 2018, 4, (2018,9,25), (2018, 10, 1)),
				(201805, 2018, 5, (2018,10,2), (2018, 10, 8)),
				(201806, 2018, 6, (2018,10,9), (2018, 10, 15)),
				(201807, 2018, 7, (2018,10,16), (2018, 10, 22)),
				(201808, 2018, 8, (2018,10,23), (2018, 10, 29)),
				(201809, 2018, 9, (2018,10,30), (2018, 11, 5)),
				(201810, 2018, 10, (2018,11,6), (2018, 11, 12)),
				(201811, 2018, 11, (2018,11,13), (2018, 11, 19)),
				(201812, 2018, 12, (2018,11,20), (2018, 11, 27)),
				(201813, 2018, 13, (2018,11,28), (2018, 12, 3)),
				(201814, 2018, 14, (2018,12,4), (2018, 12, 10)),
				(201815, 2018, 15, (2018,12,11), (2018, 12, 17)),
				(201816, 2018, 16, (2018,12,18), (2018, 12, 24)),
				(201817, 2018, 17, (2018,12,25), (2018, 12, 31)),
			]

URL_2018 = [
			(2018, 61, 21676)
			]


if __name__ == "__main__":
	# Deployment process
		# Franchise

	print (sys.argv[1])
	if sys.argv[1] == '99':
		print ("FULL DEPLOY")
		dep= Deploy()
		for franchise in FRANCHISE_DATA:
			dep.franchise_populate(franchise[0], franchise[1], franchise[2], franchise[3])
		dep.commit('Franchise')

		# 	# URL reference
		dep.create_tables()
		for row in URL_DATA:
			dep.url_populate(row[0], row[1], row[2])
		dep.commit('URL Reference')

			#Jobs
		for job in JOB_DATA:
			dep.job_populate(job[0], job[1], job[2])
		dep.commit('Job Dimension')

			#Calendar
		for calendar in JOB_CALENDAR_DATA:
			dep.calendar_populate(calendar[0], calendar[1])
		dep.commit('Job Calendar')

			#Week
		for week in WEEK_DATA:
			dep.week_populate(week[0], week[1], week[2], week[3], week[4])
		dep.commit()

	elif sys.argv[1] == '2018':
		print ("DEPLOY 2018 UPDATES")

		dep= Deploy()
		print ("WEEK")
		for week in WEEKS_2018:
			dep.week_populate(week[0], week[1], week[2], week[3], week[4])
		dep.commit()

		for row in URL_2018:
			print ("URL")
			dep.url_populate(row[0], row[1], row[2])
		dep.commit()
	else:
		print ("NO UPDATES MADE")
